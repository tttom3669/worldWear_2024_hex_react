import{r as u}from"./react-Wu2nlj90.js";import{w as R}from"./use-sync-external-store-CJkxCFMj.js";function E(n){n()}function N(){let n=null,o=null;return{clear(){n=null,o=null},notify(){E(()=>{let r=n;for(;r;)r.callback(),r=r.next})},get(){const r=[];let t=n;for(;t;)r.push(t),t=t.next;return r},subscribe(r){let t=!0;const e=o={callback:r,next:null,prev:o};return e.prev?e.prev.next=e:n=e,function(){!t||n===null||(t=!1,e.next?e.next.prev=e.prev:o=e.prev,e.prev?e.prev.next=e.next:n=e.next)}}}}var C={notify(){},get:()=>[]};function L(n,o){let r,t=C,e=0,i=!1;function c(m){b();const w=t.subscribe(m);let g=!1;return()=>{g||(g=!0,w(),l())}}function a(){t.notify()}function s(){S.onStateChange&&S.onStateChange()}function f(){return i}function b(){e++,r||(r=n.subscribe(s),t=N())}function l(){e--,r&&e===0&&(r(),r=void 0,t.clear(),t=C)}function x(){i||(i=!0,b())}function y(){i&&(i=!1,l())}const S={addNestedSub:c,notifyNestedSubs:a,handleChangeWrapper:s,isSubscribed:f,trySubscribe:x,tryUnsubscribe:y,getListeners:()=>t};return S}var M=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",U=M(),V=()=>typeof navigator<"u"&&navigator.product==="ReactNative",k=V(),P=()=>U||k?u.useLayoutEffect:u.useEffect,D=P(),v=Symbol.for("react-redux-context"),p=typeof globalThis<"u"?globalThis:{};function I(){if(!u.createContext)return{};const n=p[v]??(p[v]=new Map);let o=n.get(u.createContext);return o||(o=u.createContext(null),n.set(u.createContext,o)),o}var d=I();function H(n){const{children:o,context:r,serverState:t,store:e}=n,i=u.useMemo(()=>{const s=L(e);return{store:e,subscription:s,getServerState:t?()=>t:void 0}},[e,t]),c=u.useMemo(()=>e.getState(),[e]);D(()=>{const{subscription:s}=i;return s.onStateChange=s.notifyNestedSubs,s.trySubscribe(),c!==e.getState()&&s.notifyNestedSubs(),()=>{s.tryUnsubscribe(),s.onStateChange=void 0}},[i,c]);const a=r||d;return u.createElement(a.Provider,{value:i},o)}var B=H;function h(n=d){return function(){return u.useContext(n)}}var T=h(),W=(n,o)=>n===o;function j(n=d){const o=n===d?T:h(n),r=(t,e={})=>{const{equalityFn:i=W}=typeof e=="function"?{equalityFn:e}:e,c=o(),{store:a,subscription:s,getServerState:f}=c;u.useRef(!0);const b=u.useCallback({[t.name](x){return t(x)}}[t.name],[t]),l=R.useSyncExternalStoreWithSelector(s.addNestedSub,a.getState,f||a.getState,b,i);return u.useDebugValue(l),l};return Object.assign(r,{withTypes:()=>r}),r}var _=j();export{B as P,_ as u};
